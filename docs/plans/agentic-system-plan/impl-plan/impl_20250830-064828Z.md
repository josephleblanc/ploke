# Implementation Log — AI Temp Outputs + Visitor

Scope
- Enable tests to optionally write API JSON outputs into `crates/ploke-tui/ai_temp_data/` for inspection.
- Add json_visitor variants that can write stats into the same directory.

Changes
- `json_visitor.rs`:
  - Added `explore_file_visit_to_dir(input, out_dir)` to emit `*_stats.txt` and `*_stats.json` into a specified directory.
  - Added `explore_endpoints_file_visit_to_dir(input, out_dir)` for the endpoints shape `{ data: { endpoints: [...] } }`.
- `openrouter/models.rs` tests:
  - `flakey_models_all_raw`: now, when `PLOKE_AI_TMP` is set, also writes `models_all_raw.json` to `ai_temp_data/` and invokes `explore_file_visit_to_dir` to produce stats into the same dir.
  - Added `ai_temp_endpoint_dump_and_stats` (gated by `live_api_tests`): fetches a known endpoint via `ProvEnd::call_endpoint_raw()`, writes a timestamped JSON into `ai_temp_data/`, and runs `explore_endpoints_file_visit_to_dir` to generate stats next to it.
- `providers.rs` test (earlier step): persists providers JSON to `crates/ploke-tui/data/providers/providers-<ts>.json` for inspection.

How to run
- Models JSON + stats:
  - `PLOKE_AI_TMP=1 cargo test -p ploke-tui llm::openrouter::models::tests::flakey_models_all_raw --features live_api_tests`
  - Outputs:
    - `crates/ploke-tui/ai_temp_data/models_all_raw.json`
    - `crates/ploke-tui/ai_temp_data/models_all_raw_stats.txt`
    - `crates/ploke-tui/ai_temp_data/models_all_raw_stats.json`
- Endpoints JSON + stats:
  - `PLOKE_AI_TMP=1 cargo test -p ploke-tui llm::openrouter::models::tests::ai_temp_endpoint_dump_and_stats --features live_api_tests`
  - Outputs:
    - `crates/ploke-tui/ai_temp_data/endpoint_qwen3-30b-a3b-thinking-2507_<ts>.json`
    - `crates/ploke-tui/ai_temp_data/endpoint_qwen3-30b-a3b-thinking-2507_<ts>_stats.txt`
    - `crates/ploke-tui/ai_temp_data/endpoint_qwen3-30b-a3b-thinking-2507_<ts>_stats.json`

Notes
- This process gives us concrete artifacts to grep and compare shapes between `/models` and `/models/:author/:slug/endpoints`.
- Next, we’ll use these to finalize the `Endpoint` struct design and revisit the `provider_id` alias strategy with evidence.
