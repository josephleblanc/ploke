  2025-08-27T23:04:39.124707Z  INFO openrouter_live_kimi_tools: pretty_json:
{
  "data": {
    "architecture": {
      "input_modalities": [
        "text"
      ],
      "instruct_type": null,
      "modality": "text->text",
      "output_modalities": [
        "text"
      ],
      "tokenizer": "Other"
    },
    "created": 1752263252,
    "description": "Kimi K2 Instruct is a large-scale Mixture-of-Experts (MoE) language model developed by Moonshot AI, featuring 1 trillion total parameters with 32 billion active per forward pass. It is optimized for agentic capabilities, including advanced tool use, reasoning, and code synthesis. Kimi K2 excels across a broad range of benchmarks, particularly in coding (LiveCodeBench, SWE-bench), reasoning (ZebraLogic, GPQA), and tool-use (Tau2, AceBench) tasks. It supports long-context inference up to 128K tokens and is designed with a novel training stack that includes the MuonClip optimizer for stable large-scale MoE training.",
    "endpoints": [
      {
        "context_length": 63000,
        "max_completion_tokens": 63000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Targon | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000249",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000014",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Targon",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "repetition_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "targon/fp8",
        "uptime_last_30m": 99.26686217008798
      },
      {
        "context_length": 75000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Chutes | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000059264",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000000148088",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Chutes",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logprobs",
          "logit_bias",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "chutes/fp8",
        "uptime_last_30m": 99.67453213995118
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Nebius | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000024",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000005",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Nebius",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "logit_bias",
          "logprobs",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "nebius/fp4",
        "uptime_last_30m": 99.59083469721767
      },
      {
        "context_length": 131000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "DeepInfra | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000022",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000055",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "DeepInfra",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "repetition_penalty",
          "top_k",
          "seed",
          "min_p",
          "response_format"
        ],
        "supports_implicit_caching": false,
        "tag": "deepinfra/fp4",
        "uptime_last_30m": 98.989898989899
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Novita | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000023",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000057",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Novita",
        "quantization": "fp8",
        "status": -2,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logit_bias"
        ],
        "supports_implicit_caching": false,
        "tag": "novita/fp8",
        "uptime_last_30m": 92.97619047619048
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Fireworks | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Fireworks",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "logprobs",
          "top_logprobs",
          "response_format",
          "structured_outputs"
        ],
        "supports_implicit_caching": false,
        "tag": "fireworks/fp8",
        "uptime_last_30m": 99.9436302142052
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Moonshot AI | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.00000015",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Moonshot AI",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "moonshotai/fp8",
        "uptime_last_30m": 99.62121212121212
      },
      {
        "context_length": 131000,
        "max_completion_tokens": 131000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "BaseTen | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "BaseTen",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "stop"
        ],
        "supports_implicit_caching": false,
        "tag": "baseten/fp4",
        "uptime_last_30m": 99.76076555023924
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "AtlasCloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000007",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "AtlasCloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p"
        ],
        "supports_implicit_caching": false,
        "tag": "atlas-cloud/fp8",
        "uptime_last_30m": 99.82964224872232
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Parasail | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000299",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000099",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Parasail",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "frequency_penalty",
          "min_p",
          "presence_penalty",
          "repetition_penalty",
          "seed",
          "stop",
          "top_k"
        ],
        "supports_implicit_caching": false,
        "tag": "parasail/fp8",
        "uptime_last_30m": 100
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Together | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Together",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "min_p"
        ],
        "supports_implicit_caching": false,
        "tag": "together/fp8",
        "uptime_last_30m": 99.29411764705884
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 16384,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Groq | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.0000005",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Groq",
        "quantization": null,
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "seed",
          "response_format"
        ],
        "supports_implicit_caching": true,
        "tag": "groq",
        "uptime_last_30m": 99.53051643192488
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "GMICloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "GMICloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "seed"
        ],
        "supports_implicit_caching": false,
        "tag": "gmicloud/fp8",
        "uptime_last_30m": null
      }
    ],
    "id": "moonshotai/kimi-k2",
    "name": "MoonshotAI: Kimi K2"
  }
}
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:39 on ThreadId(2)

  2025-08-27T23:05:15.518561Z  INFO openrouter_live_kimi_tools: pretty_json:
{
  "data": {
    "architecture": {
      "input_modalities": [
        "text"
      ],
      "instruct_type": null,
      "modality": "text->text",
      "output_modalities": [
        "text"
      ],
      "tokenizer": "Other"
    },
    "created": 1752263252,
    "description": "Kimi K2 Instruct is a large-scale Mixture-of-Experts (MoE) language model developed by Moonshot AI, featuring 1 trillion total parameters with 32 billion active per forward pass. It is optimized for agentic capabilities, including advanced tool use, reasoning, and code synthesis. Kimi K2 excels across a broad range of benchmarks, particularly in coding (LiveCodeBench, SWE-bench), reasoning (ZebraLogic, GPQA), and tool-use (Tau2, AceBench) tasks. It supports long-context inference up to 128K tokens and is designed with a novel training stack that includes the MuonClip optimizer for stable large-scale MoE training.",
    "endpoints": [
      {
        "context_length": 63000,
        "max_completion_tokens": 63000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Targon | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000249",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000014",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Targon",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "repetition_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "targon/fp8",
        "uptime_last_30m": 99.26686217008798
      },
      {
        "context_length": 75000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Chutes | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000059264",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000000148088",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Chutes",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logprobs",
          "logit_bias",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "chutes/fp8",
        "uptime_last_30m": 99.67453213995118
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Nebius | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000024",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000005",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Nebius",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "logit_bias",
          "logprobs",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "nebius/fp4",
        "uptime_last_30m": 99.59083469721767
      },
      {
        "context_length": 131000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "DeepInfra | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000022",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000055",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "DeepInfra",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "repetition_penalty",
          "top_k",
          "seed",
          "min_p",
          "response_format"
        ],
        "supports_implicit_caching": false,
        "tag": "deepinfra/fp4",
        "uptime_last_30m": 98.989898989899
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Novita | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000023",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000057",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Novita",
        "quantization": "fp8",
        "status": -2,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logit_bias"
        ],
        "supports_implicit_caching": false,
        "tag": "novita/fp8",
        "uptime_last_30m": 92.97619047619048
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Fireworks | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Fireworks",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "logprobs",
          "top_logprobs",
          "response_format",
          "structured_outputs"
        ],
        "supports_implicit_caching": false,
        "tag": "fireworks/fp8",
        "uptime_last_30m": 99.9436302142052
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Moonshot AI | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.00000015",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Moonshot AI",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "moonshotai/fp8",
        "uptime_last_30m": 99.62121212121212
      },
      {
        "context_length": 131000,
        "max_completion_tokens": 131000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "BaseTen | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "BaseTen",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "stop"
        ],
        "supports_implicit_caching": false,
        "tag": "baseten/fp4",
        "uptime_last_30m": 99.76076555023924
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "AtlasCloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000007",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "AtlasCloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p"
        ],
        "supports_implicit_caching": false,
        "tag": "atlas-cloud/fp8",
        "uptime_last_30m": 99.82964224872232
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Parasail | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000299",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000099",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Parasail",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "frequency_penalty",
          "min_p",
          "presence_penalty",
          "repetition_penalty",
          "seed",
          "stop",
          "top_k"
        ],
        "supports_implicit_caching": false,
        "tag": "parasail/fp8",
        "uptime_last_30m": 100
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Together | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Together",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "min_p"
        ],
        "supports_implicit_caching": false,
        "tag": "together/fp8",
        "uptime_last_30m": 99.29411764705884
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 16384,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Groq | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.0000005",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Groq",
        "quantization": null,
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "seed",
          "response_format"
        ],
        "supports_implicit_caching": true,
        "tag": "groq",
        "uptime_last_30m": 99.53051643192488
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "GMICloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "GMICloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "seed"
        ],
        "supports_implicit_caching": false,
        "tag": "gmicloud/fp8",
        "uptime_last_30m": null
      }
    ],
    "id": "moonshotai/kimi-k2",
    "name": "MoonshotAI: Kimi K2"
  }
}
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:39 on ThreadId(2)

  2025-08-27T23:06:19.870097Z  INFO ploke_rag::core: close, time.busy: 31.1µs, time.idle: 23.2µs
    at crates/ploke-rag/src/core/mod.rs:324 on ThreadId(2)
    in ploke_rag::core::bm25_rebuild

  2025-08-27T23:06:21.762403Z  INFO e2e_openrouter_tools_app: models/user returned 322 entries
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:353 on ThreadId(2)

  2025-08-27T23:06:22.210301Z  INFO e2e_openrouter_tools_app: Full response infodump:
Object {
    "data": Array [
        Object {
            "name": String("Z.AI"),
            "privacy_policy_url": Null,
            "slug": String("z-ai"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("SambaNova"),
            "privacy_policy_url": String("https://sambanova.ai/privacy-policy"),
            "slug": String("sambanova"),
            "status_page_url": String("https://status.sambanova.ai/"),
            "terms_of_service_url": String("https://sambanova.ai/terms-and-conditions"),
        },
        Object {
            "name": String("Kluster"),
            "privacy_policy_url": String("https://www.kluster.ai/privacy-policy"),
            "slug": String("klusterai"),
            "status_page_url": String("https://status.klusterai.dev/"),
            "terms_of_service_url": String("https://www.kluster.ai/terms-of-use"),
        },
        Object {
            "name": String("Together"),
            "privacy_policy_url": String("https://www.together.ai/privacy"),
            "slug": String("together"),
            "status_page_url": String("https://status.together.ai/"),
            "terms_of_service_url": String("https://www.together.ai/terms-of-service"),
        },
        Object {
            "name": String("Cerebras"),
            "privacy_policy_url": String("https://www.cerebras.ai/privacy-policy"),
            "slug": String("cerebras"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.cerebras.ai/terms-of-service"),
        },
        Object {
            "name": String("Venice"),
            "privacy_policy_url": String("https://venice.ai/legal/privacy-policy"),
            "slug": String("venice"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://venice.ai/legal/tos"),
        },
        Object {
            "name": String("Morph"),
            "privacy_policy_url": String("https://morphllm.com/privacy"),
            "slug": String("morph"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Moonshot AI"),
            "privacy_policy_url": String("https://platform.moonshot.ai/docs/agreement/userprivacy"),
            "slug": String("moonshotai"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://platform.moonshot.ai/docs/agreement/modeluse"),
        },
        Object {
            "name": String("OpenAI"),
            "privacy_policy_url": String("https://openai.com/policies/privacy-policy/"),
            "slug": String("openai"),
            "status_page_url": String("https://status.openai.com/"),
            "terms_of_service_url": String("https://openai.com/policies/row-terms-of-use/"),
        },
        Object {
            "name": String("Stealth"),
            "privacy_policy_url": Null,
            "slug": String("stealth"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("WandB"),
            "privacy_policy_url": Null,
            "slug": String("wandb"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("AtlasCloud"),
            "privacy_policy_url": String("https://www.atlascloud.ai/privacy"),
            "slug": String("atlas-cloud"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Amazon Bedrock"),
            "privacy_policy_url": String("https://aws.amazon.com/privacy"),
            "slug": String("amazon-bedrock"),
            "status_page_url": String("https://health.aws.amazon.com/health/status"),
            "terms_of_service_url": String("https://aws.amazon.com/service-terms/"),
        },
        Object {
            "name": String("Groq"),
            "privacy_policy_url": String("https://groq.com/privacy-policy/"),
            "slug": String("groq"),
            "status_page_url": String("https://status.groq.com/"),
            "terms_of_service_url": String("https://groq.com/terms-of-use/"),
        },
        Object {
            "name": String("Featherless"),
            "privacy_policy_url": String("https://featherless.ai/privacy"),
            "slug": String("featherless"),
            "status_page_url": String("https://featherless.ai/status"),
            "terms_of_service_url": String("https://featherless.ai/terms"),
        },
        Object {
            "name": String("NextBit"),
            "privacy_policy_url": String("https://www.nextbit256.com/docs/privacy-policy"),
            "slug": String("nextbit"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.nextbit256.com/docs/terms-of-service"),
        },
        Object {
            "name": String("Atoma"),
            "privacy_policy_url": Null,
            "slug": String("atoma"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://atoma.network/terms_of_service"),
        },
        Object {
            "name": String("BaseTen"),
            "privacy_policy_url": String("https://www.baseten.co/privacy-policy"),
            "slug": String("baseten"),
            "status_page_url": String("https://status.baseten.co/"),
            "terms_of_service_url": String("https://www.baseten.co/terms-and-conditions"),
        },
        Object {
            "name": String("AI21"),
            "privacy_policy_url": String("https://www.ai21.com/privacy-policy/"),
            "slug": String("ai21"),
            "status_page_url": String("https://status.ai21.com/"),
            "terms_of_service_url": String("https://www.ai21.com/terms-of-service/"),
        },
        Object {
            "name": String("Minimax"),
            "privacy_policy_url": String("https://www.minimax.io/platform/protocol/privacy-policy"),
            "slug": String("minimax"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.minimax.io/platform/protocol/terms-of-service"),
        },
        Object {
            "name": String("Mistral"),
            "privacy_policy_url": String("https://mistral.ai/terms/#privacy-policy"),
            "slug": String("mistral"),
            "status_page_url": String("https://status.mistral.ai/"),
            "terms_of_service_url": String("https://mistral.ai/terms/#terms-of-use"),
        },
        Object {
            "name": String("Anthropic"),
            "privacy_policy_url": String("https://www.anthropic.com/legal/privacy"),
            "slug": String("anthropic"),
            "status_page_url": String("https://status.anthropic.com/"),
            "terms_of_service_url": String("https://www.anthropic.com/legal/commercial-terms"),
        },
        Object {
            "name": String("Lambda"),
            "privacy_policy_url": String("https://lambda.ai/legal/privacy-policy"),
            "slug": String("lambda"),
            "status_page_url": String("https://status.lambdalabs.com/"),
            "terms_of_service_url": String("https://lambda.ai/legal/terms-of-service"),
        },
        Object {
            "name": String("Hyperbolic"),
            "privacy_policy_url": String("https://hyperbolic.xyz/privacy"),
            "slug": String("hyperbolic"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://hyperbolic.xyz/terms"),
        },
        Object {
            "name": String("NCompass"),
            "privacy_policy_url": String("https://ncompass.tech/privacy"),
            "slug": String("ncompass"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://ncompass.tech/terms"),
        },
        Object {
            "name": String("Azure"),
            "privacy_policy_url": String("https://www.microsoft.com/en-us/privacy/privacystatement"),
            "slug": String("azure"),
            "status_page_url": String("https://status.azure.com/"),
            "terms_of_service_url": String("https://www.microsoft.com/en-us/legal/terms-of-use?oneroute=true"),
        },
        Object {
            "name": String("DeepSeek"),
            "privacy_policy_url": String("https://chat.deepseek.com/downloads/DeepSeek%20Privacy%20Policy.html"),
            "slug": String("deepseek"),
            "status_page_url": String("https://status.deepseek.com/"),
            "terms_of_service_url": String("https://chat.deepseek.com/downloads/DeepSeek%20Terms%20of%20Use.html"),
        },
        Object {
            "name": String("Crusoe"),
            "privacy_policy_url": String("https://legal.crusoe.ai/open-router#cloud-privacy-policy"),
            "slug": String("crusoe"),
            "status_page_url": String("https://status.crusoecloud.com/"),
            "terms_of_service_url": String("https://legal.crusoe.ai/open-router#managed-inference-tos-open-router"),
        },
        Object {
            "name": String("Cohere"),
            "privacy_policy_url": String("https://cohere.com/privacy"),
            "slug": String("cohere"),
            "status_page_url": String("https://status.cohere.ai/"),
            "terms_of_service_url": String("https://cohere.com/terms-of-use"),
        },
        Object {
            "name": String("Google"),
            "privacy_policy_url": String("https://cloud.google.com/terms/cloud-privacy-notice"),
            "slug": String("google-vertex"),
            "status_page_url": String("https://status.cloud.google.com/products/sdXM79fz1FS6ekNpu37K/history"),
            "terms_of_service_url": String("https://cloud.google.com/terms/"),
        },
        Object {
            "name": String("Mancer 2"),
            "privacy_policy_url": String("https://mancer.tech/privacy"),
            "slug": String("mancer"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://mancer.tech/terms"),
        },
        Object {
            "name": String("Perplexity"),
            "privacy_policy_url": String("https://www.perplexity.ai/hub/legal/privacy-policy"),
            "slug": String("perplexity"),
            "status_page_url": String("https://status.perplexity.ai/"),
            "terms_of_service_url": String("https://www.perplexity.ai/hub/legal/perplexity-api-terms-of-service"),
        },
        Object {
            "name": String("Avian"),
            "privacy_policy_url": String("https://avian.io/privacy"),
            "slug": String("avian"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://avian.io/terms"),
        },
        Object {
            "name": String("Novita"),
            "privacy_policy_url": String("https://novita.ai/legal/privacy-policy"),
            "slug": String("novita"),
            "status_page_url": String("https://status.novita.ai/"),
            "terms_of_service_url": String("https://novita.ai/legal/terms-of-service"),
        },
        Object {
            "name": String("SiliconFlow"),
            "privacy_policy_url": Null,
            "slug": String("siliconflow"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Switchpoint"),
            "privacy_policy_url": Null,
            "slug": String("switchpoint"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Fireworks"),
            "privacy_policy_url": String("https://fireworks.ai/privacy-policy"),
            "slug": String("fireworks"),
            "status_page_url": String("https://status.fireworks.ai/"),
            "terms_of_service_url": String("https://fireworks.ai/terms-of-service"),
        },
        Object {
            "name": String("Inflection"),
            "privacy_policy_url": String("https://inflection.ai/privacy-policy"),
            "slug": String("inflection"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://developers.inflection.ai/tos"),
        },
        Object {
            "name": String("xAI"),
            "privacy_policy_url": String("https://x.ai/legal/privacy-policy"),
            "slug": String("xai"),
            "status_page_url": String("https://status.x.ai/"),
            "terms_of_service_url": String("https://x.ai/legal/terms-of-service-enterprise"),
        },
        Object {
            "name": String("Google AI Studio"),
            "privacy_policy_url": String("https://cloud.google.com/terms/cloud-privacy-notice"),
            "slug": String("google-ai-studio"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://cloud.google.com/terms/"),
        },
        Object {
            "name": String("Infermatic"),
            "privacy_policy_url": String("https://infermatic.ai/privacy-policy/"),
            "slug": String("infermatic"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://infermatic.ai/terms-and-conditions/"),
        },
        Object {
            "name": String("InferenceNet"),
            "privacy_policy_url": String("https://inference.net/privacy-policy"),
            "slug": String("inference-net"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://inference.net/terms-of-service"),
        },
        Object {
            "name": String("Inception"),
            "privacy_policy_url": String("https://www.inceptionlabs.ai/terms#privacy-policy"),
            "slug": String("inception"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.inceptionlabs.ai/terms"),
        },
        Object {
            "name": String("Targon"),
            "privacy_policy_url": String("https://targon.com/privacy"),
            "slug": String("targon"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://targon.com/terms"),
        },
        Object {
            "name": String("Nebius"),
            "privacy_policy_url": String("https://docs.nebius.com/legal/studio/privacy/"),
            "slug": String("nebius"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://docs.nebius.com/legal/studio/terms-of-use/"),
        },
        Object {
            "name": String("Alibaba"),
            "privacy_policy_url": String("https://www.alibabacloud.com/help/en/legal/latest/alibaba-cloud-international-website-privacy-policy"),
            "slug": String("alibaba"),
            "status_page_url": String("https://status.alibabacloud.com/"),
            "terms_of_service_url": String("https://www.alibabacloud.com/help/en/legal/latest/alibaba-cloud-international-website-product-terms-of-service-v-3-8-0"),
        },
        Object {
            "name": String("Chutes"),
            "privacy_policy_url": Null,
            "slug": String("chutes"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://chutes.ai/tos"),
        },
        Object {
            "name": String("Friendli"),
            "privacy_policy_url": String("https://friendli.ai/privacypolicy"),
            "slug": String("friendli"),
            "status_page_url": String("https://status.friendli.ai/"),
            "terms_of_service_url": String("https://friendli.ai/terms-of-service"),
        },
        Object {
            "name": String("Ubicloud"),
            "privacy_policy_url": String("https://www.ubicloud.com/docs/about/privacy-policy"),
            "slug": String("ubicloud"),
            "status_page_url": String("https://status.ubicloud.com/"),
            "terms_of_service_url": String("https://www.ubicloud.com/docs/about/terms-of-service"),
        },
        Object {
            "name": String("Cloudflare"),
            "privacy_policy_url": String("https://developers.cloudflare.com/workers-ai/privacy"),
            "slug": String("cloudflare"),
            "status_page_url": String("https://www.cloudflarestatus.com/"),
            "terms_of_service_url": String("https://www.cloudflare.com/service-specific-terms-developer-platform/#developer-platform-terms"),
        },
        Object {
            "name": String("AionLabs"),
            "privacy_policy_url": String("https://www.aionlabs.ai/privacy-policy/"),
            "slug": String("aion-labs"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.aionlabs.ai/terms/"),
        },
        Object {
            "name": String("Liquid"),
            "privacy_policy_url": String("https://www.liquid.ai/privacy-policy"),
            "slug": String("liquid"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.liquid.ai/terms-conditions"),
        },
        Object {
            "name": String("DeepInfra"),
            "privacy_policy_url": String("https://deepinfra.com/privacy"),
            "slug": String("deepinfra"),
            "status_page_url": String("https://status.deepinfra.com/"),
            "terms_of_service_url": String("https://deepinfra.com/terms"),
        },
        Object {
            "name": String("Nineteen"),
            "privacy_policy_url": Null,
            "slug": String("nineteen"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://nineteen.ai/tos"),
        },
        Object {
            "name": String("Enfer"),
            "privacy_policy_url": String("https://enfer.ai/privacy-policy"),
            "slug": String("enfer"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://enfer.ai/privacy-policy"),
        },
        Object {
            "name": String("CrofAI"),
            "privacy_policy_url": String("https://ai.nahcrof.com/privacy"),
            "slug": String("crofai"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Phala"),
            "privacy_policy_url": String("https://red-pill.ai/privacy"),
            "slug": String("phala"),
            "status_page_url": String("https://status.phala.network/"),
            "terms_of_service_url": String("https://red-pill.ai/terms"),
        },
        Object {
            "name": String("OpenInference"),
            "privacy_policy_url": String("https://www.openinference.xyz/terms"),
            "slug": String("open-inference"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.openinference.xyz/terms"),
        },
        Object {
            "name": String("Meta"),
            "privacy_policy_url": String("https://www.facebook.com/privacy/policy/"),
            "slug": String("meta"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://llama.developer.meta.com/legal/terms-of-service"),
        },
        Object {
            "name": String("Parasail"),
            "privacy_policy_url": String("https://www.parasail.io/legal/privacy-policy"),
            "slug": String("parasail"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.parasail.io/legal/terms"),
        },
        Object {
            "name": String("GMICloud"),
            "privacy_policy_url": String("https://docs.gmicloud.ai/privacy"),
            "slug": String("gmicloud"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
    ],
}

    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:375 on ThreadId(2)

  2025-08-27T23:06:22.210884Z  INFO e2e_openrouter_tools_app: model: x-ai/grok-code-fast-1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:06:22.369535Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for x-ai/grok-code-fast-1: xAI | x-ai/grok-code-fast-1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:06:22.369886Z  INFO ploke_tui::event_bus: close, time.busy: 25.3µs, time.idle: 9.80µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: eda489d2-42fa-4eaf-93c1-3959ee2ef89f, content: "Switched active model to x-ai/grok-code-fast-1 via provider xai---x-ai-grok-code-fast-1", kind: SysInfo

  2025-08-27T23:06:22.369971Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 168µs, time.idle: 34.7µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: eda489d2-42fa-4eaf-93c1-3959ee2ef89f, content: "Switched active model to x-ai/grok-code-fast-1 via provider xai---x-ai-grok-code-fast-1", kind: SysInfo

  2025-08-27T23:06:22.370009Z  INFO ploke_tui::event_bus: close, time.busy: 4.14µs, time.idle: 4.63µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:22.470804Z  INFO ploke_tui::event_bus: close, time.busy: 32.6µs, time.idle: 21.2µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:22.470938Z  INFO ploke_tui::event_bus: close, time.busy: 2.87µs, time.idle: 2.92µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:22.471021Z  INFO ploke_tui::llm: Received LLM request for parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709
new_msg_id: 288ada1d-379d-4298-804a-83a5d47a83fd
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:06:22.471044Z  INFO ploke_tui::llm: Received context for parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:06:22.471078Z  INFO ploke_tui::llm: pending_requests found match for req_parent: a609a5d0-992b-413c-9626-2bad1e4ed709
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:06:22.471088Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: a609a5d0-992b-413c-9626-2bad1e4ed709
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:06:22.471112Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:06:22.471186Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 992a0a39-4a47-47ab-9a28-3af7c822a730, parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 288ada1d-379d-4298-804a-83a5d47a83fd }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709 })

  2025-08-27T23:06:22.471212Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 992a0a39-4a47-47ab-9a28-3af7c822a730, parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 288ada1d-379d-4298-804a-83a5d47a83fd }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709 })

  2025-08-27T23:06:22.471275Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 992a0a39-4a47-47ab-9a28-3af7c822a730, parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 288ada1d-379d-4298-804a-83a5d47a83fd }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709 })

  2025-08-27T23:06:22.471300Z  INFO ploke_tui::llm: close, time.busy: 91.3µs, time.idle: 41.5µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 992a0a39-4a47-47ab-9a28-3af7c822a730, parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 288ada1d-379d-4298-804a-83a5d47a83fd }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: a609a5d0-992b-413c-9626-2bad1e4ed709 })

  2025-08-27T23:06:42.521684Z  INFO e2e_openrouter_tools_app: model: nousresearch/hermes-4-70b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:06:42.668134Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for nousresearch/hermes-4-70b: Chutes | nousresearch/hermes-4-70b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:06:42.668385Z  INFO ploke_tui::event_bus: close, time.busy: 22.3µs, time.idle: 5.36µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: f0f3348d-0c43-4b87-a625-dc95f87b1701, content: "Switched active model to nousresearch/hermes-4-70b via provider chutes---nousresearch-hermes-4-70b", kind: SysInfo

  2025-08-27T23:06:42.668437Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 98.5µs, time.idle: 21.4µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: f0f3348d-0c43-4b87-a625-dc95f87b1701, content: "Switched active model to nousresearch/hermes-4-70b via provider chutes---nousresearch-hermes-4-70b", kind: SysInfo

  2025-08-27T23:06:42.668457Z  INFO ploke_tui::event_bus: close, time.busy: 2.09µs, time.idle: 2.30µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:42.769906Z  INFO ploke_tui::event_bus: close, time.busy: 42.0µs, time.idle: 50.7µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:42.770060Z  INFO ploke_tui::event_bus: close, time.busy: 4.76µs, time.idle: 5.48µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:06:42.770144Z  INFO ploke_tui::llm: Received LLM request for parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2
new_msg_id: 7003329d-11ae-46d2-ba63-f905a1615952
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:06:42.770164Z  INFO ploke_tui::llm: Received context for parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:06:42.770187Z  INFO ploke_tui::llm: pending_requests found match for req_parent: 75f63dcd-8305-475f-86b3-317df9a0d0c2
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:06:42.770196Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: 75f63dcd-8305-475f-86b3-317df9a0d0c2
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:06:42.770217Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:06:42.770283Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: e6099327-9cf7-491b-81f7-2aa04f663829, parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 7003329d-11ae-46d2-ba63-f905a1615952 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2 })

  2025-08-27T23:06:42.770303Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: e6099327-9cf7-491b-81f7-2aa04f663829, parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 7003329d-11ae-46d2-ba63-f905a1615952 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2 })

  2025-08-27T23:06:42.770363Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: e6099327-9cf7-491b-81f7-2aa04f663829, parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 7003329d-11ae-46d2-ba63-f905a1615952 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2 })

  2025-08-27T23:06:42.770386Z  INFO ploke_tui::llm: close, time.busy: 81.1µs, time.idle: 39.3µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: e6099327-9cf7-491b-81f7-2aa04f663829, parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 7003329d-11ae-46d2-ba63-f905a1615952 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 75f63dcd-8305-475f-86b3-317df9a0d0c2 })

  2025-08-27T23:07:02.831193Z  INFO e2e_openrouter_tools_app: model: nousresearch/hermes-4-405b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:03.034540Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for nousresearch/hermes-4-405b: Chutes | nousresearch/hermes-4-405b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:03.034928Z  INFO ploke_tui::event_bus: close, time.busy: 29.6µs, time.idle: 9.96µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: d9214066-5143-4f00-a9d6-2e395571f9a5, content: "Switched active model to nousresearch/hermes-4-405b via provider chutes---nousresearch-hermes-4-405b", kind: SysInfo

  2025-08-27T23:07:03.035012Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 160µs, time.idle: 44.8µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: d9214066-5143-4f00-a9d6-2e395571f9a5, content: "Switched active model to nousresearch/hermes-4-405b via provider chutes---nousresearch-hermes-4-405b", kind: SysInfo

  2025-08-27T23:07:03.035032Z  INFO ploke_tui::event_bus: close, time.busy: 2.22µs, time.idle: 2.33µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:03.135409Z  INFO ploke_tui::event_bus: close, time.busy: 33.0µs, time.idle: 20.7µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:03.135565Z  INFO ploke_tui::event_bus: close, time.busy: 4.98µs, time.idle: 5.22µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:03.135650Z  INFO ploke_tui::llm: Received LLM request for parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21
new_msg_id: 0c48bad2-d31e-4446-9863-3839a87a1bba
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:07:03.135678Z  INFO ploke_tui::llm: Received context for parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:07:03.135715Z  INFO ploke_tui::llm: pending_requests found match for req_parent: 2c6914f6-b2f9-4444-b95c-6b082cad3e21
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:07:03.135730Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: 2c6914f6-b2f9-4444-b95c-6b082cad3e21
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:07:03.135762Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:07:03.135895Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: bcdccfb7-5490-40fb-bf78-c4f9978aff54, parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 0c48bad2-d31e-4446-9863-3839a87a1bba }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 5 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21 })

  2025-08-27T23:07:03.135938Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: bcdccfb7-5490-40fb-bf78-c4f9978aff54, parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 0c48bad2-d31e-4446-9863-3839a87a1bba }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 5 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21 })

  2025-08-27T23:07:03.136057Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: bcdccfb7-5490-40fb-bf78-c4f9978aff54, parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 0c48bad2-d31e-4446-9863-3839a87a1bba }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 5 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21 })

  2025-08-27T23:07:03.136111Z  INFO ploke_tui::llm: close, time.busy: 178µs, time.idle: 74.5µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: bcdccfb7-5490-40fb-bf78-c4f9978aff54, parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 0c48bad2-d31e-4446-9863-3839a87a1bba }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 5 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 2c6914f6-b2f9-4444-b95c-6b082cad3e21 })

  2025-08-27T23:07:23.195107Z  INFO e2e_openrouter_tools_app: model: google/gemini-2.5-flash-image-preview:free
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:23.354582Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for google/gemini-2.5-flash-image-preview:free: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:23.354628Z  WARN e2e_openrouter_tools_app: google/gemini-2.5-flash-image-preview:free | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:191 on ThreadId(2)

  2025-08-27T23:07:23.354637Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping google/gemini-2.5-flash-image-preview:free
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:411 on ThreadId(2)

  2025-08-27T23:07:23.354644Z  INFO e2e_openrouter_tools_app: model: google/gemini-2.5-flash-image-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:23.622877Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for google/gemini-2.5-flash-image-preview: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:23.622974Z  WARN e2e_openrouter_tools_app: google/gemini-2.5-flash-image-preview | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:191 on ThreadId(2)

  2025-08-27T23:07:23.622995Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping google/gemini-2.5-flash-image-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:411 on ThreadId(2)

  2025-08-27T23:07:23.623009Z  INFO e2e_openrouter_tools_app: model: deepseek/deepseek-chat-v3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:24.078969Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for deepseek/deepseek-chat-v3.1: Chutes | deepseek/deepseek-chat-v3.1, DeepInfra | deepseek/deepseek-chat-v3.1, Fireworks | deepseek/deepseek-chat-v3.1, DeepSeek | deepseek/deepseek-chat-v3.1, DeepSeek | deepseek/deepseek-chat-v3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:24.079225Z  INFO ploke_tui::event_bus: close, time.busy: 22.7µs, time.idle: 5.60µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 87394f2d-bc38-44b8-a717-47098c2d4f36, content: "Switched active model to deepseek/deepseek-chat-v3.1 via provider chutes---deepseek-deepseek-chat-v3-1", kind: SysInfo

  2025-08-27T23:07:24.079278Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 101µs, time.idle: 22.4µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 87394f2d-bc38-44b8-a717-47098c2d4f36, content: "Switched active model to deepseek/deepseek-chat-v3.1 via provider chutes---deepseek-deepseek-chat-v3-1", kind: SysInfo

  2025-08-27T23:07:24.079297Z  INFO ploke_tui::event_bus: close, time.busy: 2.16µs, time.idle: 2.26µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:24.181064Z  INFO ploke_tui::event_bus: close, time.busy: 41.7µs, time.idle: 28.4µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:24.181217Z  INFO ploke_tui::event_bus: close, time.busy: 4.54µs, time.idle: 5.12µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:24.181301Z  INFO ploke_tui::llm: Received LLM request for parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75
new_msg_id: bcfc2906-5d25-4378-ba94-191d06e81973
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:07:24.181333Z  INFO ploke_tui::llm: Received context for parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:07:24.181369Z  INFO ploke_tui::llm: pending_requests found match for req_parent: 0ef3a51f-c409-4f30-ac64-f84918160b75
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:07:24.181384Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: 0ef3a51f-c409-4f30-ac64-f84918160b75
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:07:24.181418Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:07:24.181530Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 5b690106-9c0e-4ddf-802c-209616497b1a, parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: bcfc2906-5d25-4378-ba94-191d06e81973 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 7 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75 })

  2025-08-27T23:07:24.181563Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 5b690106-9c0e-4ddf-802c-209616497b1a, parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: bcfc2906-5d25-4378-ba94-191d06e81973 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 7 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75 })

  2025-08-27T23:07:24.181628Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 5b690106-9c0e-4ddf-802c-209616497b1a, parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: bcfc2906-5d25-4378-ba94-191d06e81973 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 7 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75 })

  2025-08-27T23:07:24.181652Z  INFO ploke_tui::llm: close, time.busy: 100µs, time.idle: 54.0µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 5b690106-9c0e-4ddf-802c-209616497b1a, parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: bcfc2906-5d25-4378-ba94-191d06e81973 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 7 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 0ef3a51f-c409-4f30-ac64-f84918160b75 })

  2025-08-27T23:07:44.235364Z  INFO e2e_openrouter_tools_app: model: deepseek/deepseek-v3.1-base
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:44.508356Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for deepseek/deepseek-v3.1-base: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:44.508432Z  WARN e2e_openrouter_tools_app: deepseek/deepseek-v3.1-base | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:191 on ThreadId(2)

  2025-08-27T23:07:44.508444Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping deepseek/deepseek-v3.1-base
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:411 on ThreadId(2)

  2025-08-27T23:07:44.508453Z  INFO e2e_openrouter_tools_app: model: openai/gpt-4o-audio-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:07:44.698704Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for openai/gpt-4o-audio-preview: OpenAI | openai/gpt-4o-audio-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:07:44.698992Z  INFO ploke_tui::event_bus: close, time.busy: 20.0µs, time.idle: 6.87µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 1d14f3ca-1e32-4b3a-b62c-9c4cb5235dc7, content: "Switched active model to openai/gpt-4o-audio-preview via provider openai---openai-gpt-4o-audio-preview", kind: SysInfo

  2025-08-27T23:07:44.699055Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 117µs, time.idle: 27.0µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 1d14f3ca-1e32-4b3a-b62c-9c4cb5235dc7, content: "Switched active model to openai/gpt-4o-audio-preview via provider openai---openai-gpt-4o-audio-preview", kind: SysInfo

  2025-08-27T23:07:44.699085Z  INFO ploke_tui::event_bus: close, time.busy: 4.02µs, time.idle: 3.51µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:44.799762Z  INFO ploke_tui::event_bus: close, time.busy: 36.6µs, time.idle: 23.7µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:44.799966Z  INFO ploke_tui::event_bus: close, time.busy: 11.4µs, time.idle: 9.60µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:07:44.800057Z  INFO ploke_tui::llm: Received LLM request for parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7
new_msg_id: d8340e47-55cb-4d82-9333-73f2f9467ff1
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:07:44.800080Z  INFO ploke_tui::llm: Received context for parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:07:44.800107Z  INFO ploke_tui::llm: pending_requests found match for req_parent: 37469866-f772-49fd-b8b5-525dd1c025d7
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:07:44.800118Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: 37469866-f772-49fd-b8b5-525dd1c025d7
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:07:44.800144Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:07:44.800213Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5202374-dbbb-401a-8edd-2b2128fdd96e, parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: d8340e47-55cb-4d82-9333-73f2f9467ff1 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 9 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7 })

  2025-08-27T23:07:44.800237Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5202374-dbbb-401a-8edd-2b2128fdd96e, parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: d8340e47-55cb-4d82-9333-73f2f9467ff1 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 9 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7 })

  2025-08-27T23:07:44.800306Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5202374-dbbb-401a-8edd-2b2128fdd96e, parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: d8340e47-55cb-4d82-9333-73f2f9467ff1 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 9 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7 })

  2025-08-27T23:07:44.800335Z  INFO ploke_tui::llm: close, time.busy: 97.8µs, time.idle: 42.0µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5202374-dbbb-401a-8edd-2b2128fdd96e, parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: d8340e47-55cb-4d82-9333-73f2f9467ff1 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 9 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: 37469866-f772-49fd-b8b5-525dd1c025d7 })

  2025-08-27T23:08:04.848215Z  INFO e2e_openrouter_tools_app: model: mistralai/mistral-medium-3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:08:05.015997Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for mistralai/mistral-medium-3.1: Mistral | mistralai/mistral-medium-3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:08:05.016376Z  INFO ploke_tui::event_bus: close, time.busy: 25.8µs, time.idle: 9.37µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: dbfb58a5-aebc-48e0-9859-42fc61f5739e, content: "Switched active model to mistralai/mistral-medium-3.1 via provider mistral---mistralai-mistral-medium-3-1", kind: SysInfo

  2025-08-27T23:08:05.016469Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 159µs, time.idle: 39.5µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: dbfb58a5-aebc-48e0-9859-42fc61f5739e, content: "Switched active model to mistralai/mistral-medium-3.1 via provider mistral---mistralai-mistral-medium-3-1", kind: SysInfo

  2025-08-27T23:08:05.016517Z  INFO ploke_tui::event_bus: close, time.busy: 5.63µs, time.idle: 7.16µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:08:05.117303Z  INFO ploke_tui::event_bus: close, time.busy: 40.7µs, time.idle: 28.0µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:08:05.117475Z  INFO ploke_tui::event_bus: close, time.busy: 5.98µs, time.idle: 16.2µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:08:05.117640Z  INFO ploke_tui::llm: Received LLM request for parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059
new_msg_id: 74337479-5fdd-4b56-8ff6-021c3dc138d4
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:08:05.117675Z  INFO ploke_tui::llm: Received context for parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:08:05.117718Z  INFO ploke_tui::llm: pending_requests found match for req_parent: d0f29508-05b0-4b80-910f-cfd8e0f46059
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:08:05.117734Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: d0f29508-05b0-4b80-910f-cfd8e0f46059
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:08:05.117774Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:08:05.117922Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 786ef260-fc15-4611-a021-53bf84feaf8f, parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 74337479-5fdd-4b56-8ff6-021c3dc138d4 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 11 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059 })

  2025-08-27T23:08:05.117964Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 786ef260-fc15-4611-a021-53bf84feaf8f, parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 74337479-5fdd-4b56-8ff6-021c3dc138d4 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 11 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059 })

  2025-08-27T23:08:05.118084Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 786ef260-fc15-4611-a021-53bf84feaf8f, parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 74337479-5fdd-4b56-8ff6-021c3dc138d4 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 11 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059 })

  2025-08-27T23:08:05.118109Z  INFO ploke_tui::llm: close, time.busy: 151µs, time.idle: 79.2µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 786ef260-fc15-4611-a021-53bf84feaf8f, parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 74337479-5fdd-4b56-8ff6-021c3dc138d4 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7fb8fc32f570, tail_position: 11 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: d0f29508-05b0-4b80-910f-cfd8e0f46059 })

  2025-08-27T23:08:25.169250Z  INFO e2e_openrouter_tools_app: model: baidu/ernie-4.5-21b-a3b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:400 on ThreadId(2)

  2025-08-27T23:08:25.500419Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for baidu/ernie-4.5-21b-a3b: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:180 on ThreadId(2)

  2025-08-27T23:08:25.500486Z  WARN e2e_openrouter_tools_app: baidu/ernie-4.5-21b-a3b | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:191 on ThreadId(2)

  2025-08-27T23:08:25.500499Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping baidu/ernie-4.5-21b-a3b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:411 on ThreadId(2)

  2025-08-27T23:08:25.500788Z  INFO e2e_openrouter_tools_app: Summary: total_outcomes=12 successes=0 no_tool_calls=12 http_404_first_leg=0 http_429_any_leg=0
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:574 on ThreadId(2)

  2025-08-27T23:09:40.103452Z  INFO openrouter_live_kimi_tools: pretty_json:
{
  "data": {
    "architecture": {
      "input_modalities": [
        "text"
      ],
      "instruct_type": null,
      "modality": "text->text",
      "output_modalities": [
        "text"
      ],
      "tokenizer": "Other"
    },
    "created": 1752263252,
    "description": "Kimi K2 Instruct is a large-scale Mixture-of-Experts (MoE) language model developed by Moonshot AI, featuring 1 trillion total parameters with 32 billion active per forward pass. It is optimized for agentic capabilities, including advanced tool use, reasoning, and code synthesis. Kimi K2 excels across a broad range of benchmarks, particularly in coding (LiveCodeBench, SWE-bench), reasoning (ZebraLogic, GPQA), and tool-use (Tau2, AceBench) tasks. It supports long-context inference up to 128K tokens and is designed with a novel training stack that includes the MuonClip optimizer for stable large-scale MoE training.",
    "endpoints": [
      {
        "context_length": 63000,
        "max_completion_tokens": 63000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Targon | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000249",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000014",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Targon",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "repetition_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "targon/fp8",
        "uptime_last_30m": 99.38650306748468
      },
      {
        "context_length": 75000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Chutes | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000059264",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000000148088",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Chutes",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logprobs",
          "logit_bias",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "chutes/fp8",
        "uptime_last_30m": 99.8294970161978
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Nebius | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000024",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000005",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Nebius",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "logit_bias",
          "logprobs",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "nebius/fp4",
        "uptime_last_30m": 99.4535519125683
      },
      {
        "context_length": 131000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "DeepInfra | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000022",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000055",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "DeepInfra",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "repetition_penalty",
          "top_k",
          "seed",
          "min_p",
          "response_format"
        ],
        "supports_implicit_caching": false,
        "tag": "deepinfra/fp4",
        "uptime_last_30m": 98.95833333333334
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Novita | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000023",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000057",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Novita",
        "quantization": "fp8",
        "status": -2,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logit_bias"
        ],
        "supports_implicit_caching": false,
        "tag": "novita/fp8",
        "uptime_last_30m": 89.46107784431138
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Fireworks | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Fireworks",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "logprobs",
          "top_logprobs",
          "response_format",
          "structured_outputs"
        ],
        "supports_implicit_caching": false,
        "tag": "fireworks/fp8",
        "uptime_last_30m": 99.9401913875598
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Moonshot AI | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.00000015",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Moonshot AI",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "moonshotai/fp8",
        "uptime_last_30m": 99.77876106194692
      },
      {
        "context_length": 131000,
        "max_completion_tokens": 131000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "BaseTen | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "BaseTen",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "stop"
        ],
        "supports_implicit_caching": false,
        "tag": "baseten/fp4",
        "uptime_last_30m": 99.84202211690362
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "AtlasCloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000007",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "AtlasCloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p"
        ],
        "supports_implicit_caching": false,
        "tag": "atlas-cloud/fp8",
        "uptime_last_30m": 99.83164983164984
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Parasail | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000299",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000099",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Parasail",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "frequency_penalty",
          "min_p",
          "presence_penalty",
          "repetition_penalty",
          "seed",
          "stop",
          "top_k"
        ],
        "supports_implicit_caching": false,
        "tag": "parasail/fp8",
        "uptime_last_30m": 100
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Together | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Together",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "min_p"
        ],
        "supports_implicit_caching": false,
        "tag": "together/fp8",
        "uptime_last_30m": 99.33920704845816
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 16384,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Groq | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.0000005",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Groq",
        "quantization": null,
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "seed",
          "response_format"
        ],
        "supports_implicit_caching": true,
        "tag": "groq",
        "uptime_last_30m": 99.3212669683258
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "GMICloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "GMICloud",
        "quantization": "fp8",
        "status": -5,
        "supported_parameters": [
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "seed"
        ],
        "supports_implicit_caching": false,
        "tag": "gmicloud/fp8",
        "uptime_last_30m": 0
      }
    ],
    "id": "moonshotai/kimi-k2",
    "name": "MoonshotAI: Kimi K2"
  }
}
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:39 on ThreadId(2)

  2025-08-27T23:15:16.921382Z  INFO openrouter_live_kimi_tools: pretty_json:
{
  "data": {
    "architecture": {
      "input_modalities": [
        "text"
      ],
      "instruct_type": null,
      "modality": "text->text",
      "output_modalities": [
        "text"
      ],
      "tokenizer": "Other"
    },
    "created": 1752263252,
    "description": "Kimi K2 Instruct is a large-scale Mixture-of-Experts (MoE) language model developed by Moonshot AI, featuring 1 trillion total parameters with 32 billion active per forward pass. It is optimized for agentic capabilities, including advanced tool use, reasoning, and code synthesis. Kimi K2 excels across a broad range of benchmarks, particularly in coding (LiveCodeBench, SWE-bench), reasoning (ZebraLogic, GPQA), and tool-use (Tau2, AceBench) tasks. It supports long-context inference up to 128K tokens and is designed with a novel training stack that includes the MuonClip optimizer for stable large-scale MoE training.",
    "endpoints": [
      {
        "context_length": 63000,
        "max_completion_tokens": 63000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Targon | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000249",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000014",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Targon",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "repetition_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "targon/fp8",
        "uptime_last_30m": 98.96602658788774
      },
      {
        "context_length": 75000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Chutes | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000059264",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000000148088",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Chutes",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logprobs",
          "logit_bias",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "chutes/fp8",
        "uptime_last_30m": 99.83079526226734
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Nebius | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000024",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000005",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Nebius",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "logit_bias",
          "logprobs",
          "top_logprobs"
        ],
        "supports_implicit_caching": false,
        "tag": "nebius/fp4",
        "uptime_last_30m": 99.52114924181964
      },
      {
        "context_length": 131000,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "DeepInfra | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000022",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000055",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "DeepInfra",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "repetition_penalty",
          "top_k",
          "seed",
          "min_p",
          "response_format"
        ],
        "supports_implicit_caching": false,
        "tag": "deepinfra/fp4",
        "uptime_last_30m": 99.00166389351082
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Novita | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000023",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000057",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Novita",
        "quantization": "fp8",
        "status": -2,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "seed",
          "top_k",
          "min_p",
          "repetition_penalty",
          "logit_bias"
        ],
        "supports_implicit_caching": false,
        "tag": "novita/fp8",
        "uptime_last_30m": 88.69257950530034
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Fireworks | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Fireworks",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "logprobs",
          "top_logprobs",
          "response_format",
          "structured_outputs"
        ],
        "supports_implicit_caching": false,
        "tag": "fireworks/fp8",
        "uptime_last_30m": 99.88412514484357
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Moonshot AI | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.00000015",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Moonshot AI",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty"
        ],
        "supports_implicit_caching": false,
        "tag": "moonshotai/fp8",
        "uptime_last_30m": 99.77957384276267
      },
      {
        "context_length": 131000,
        "max_completion_tokens": 131000,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "BaseTen | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000006",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "BaseTen",
        "quantization": "fp4",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "stop"
        ],
        "supports_implicit_caching": false,
        "tag": "baseten/fp4",
        "uptime_last_30m": 99.92277992277992
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "AtlasCloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.0000025",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.0000007",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "AtlasCloud",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p"
        ],
        "supports_implicit_caching": false,
        "tag": "atlas-cloud/fp8",
        "uptime_last_30m": 99.83333333333331
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Parasail | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.00000299",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.00000099",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Parasail",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "max_tokens",
          "temperature",
          "top_p",
          "frequency_penalty",
          "min_p",
          "presence_penalty",
          "repetition_penalty",
          "seed",
          "stop",
          "top_k"
        ],
        "supports_implicit_caching": false,
        "tag": "parasail/fp8",
        "uptime_last_30m": 99.80119284294234
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 131072,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Together | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Together",
        "quantization": "fp8",
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "frequency_penalty",
          "presence_penalty",
          "top_k",
          "repetition_penalty",
          "logit_bias",
          "min_p"
        ],
        "supports_implicit_caching": false,
        "tag": "together/fp8",
        "uptime_last_30m": 98.86104783599087
      },
      {
        "context_length": 131072,
        "max_completion_tokens": 16384,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "Groq | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "input_cache_read": "0.0000005",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "Groq",
        "quantization": null,
        "status": 0,
        "supported_parameters": [
          "tools",
          "tool_choice",
          "max_tokens",
          "temperature",
          "top_p",
          "stop",
          "seed",
          "response_format"
        ],
        "supports_implicit_caching": true,
        "tag": "groq",
        "uptime_last_30m": 99.375
      },
      {
        "context_length": 131072,
        "max_completion_tokens": null,
        "max_prompt_tokens": null,
        "model_name": "MoonshotAI: Kimi K2",
        "name": "GMICloud | moonshotai/kimi-k2",
        "pricing": {
          "completion": "0.000003",
          "discount": 0,
          "image": "0",
          "image_output": "0",
          "internal_reasoning": "0",
          "prompt": "0.000001",
          "request": "0",
          "web_search": "0"
        },
        "provider_name": "GMICloud",
        "quantization": "fp8",
        "status": -5,
        "supported_parameters": [
          "structured_outputs",
          "response_format",
          "max_tokens",
          "temperature",
          "top_p",
          "seed"
        ],
        "supports_implicit_caching": false,
        "tag": "gmicloud/fp8",
        "uptime_last_30m": 0
      }
    ],
    "id": "moonshotai/kimi-k2",
    "name": "MoonshotAI: Kimi K2"
  }
}
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:40 on ThreadId(2)

  2025-08-27T23:16:11.710475Z  INFO openrouter_live_kimi_tools: pretty_json:
[
  {
    "id": "",
    "name": "Targon | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000014",
      "completion": "0.00000249",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 63000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "repetition_penalty"
    ]
  },
  {
    "id": "",
    "name": "Chutes | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000000148088",
      "completion": "0.00000059264",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 75000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logprobs",
      "logit_bias",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "Nebius | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000005",
      "completion": "0.0000024",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "logit_bias",
      "logprobs",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "DeepInfra | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000055",
      "completion": "0.0000022",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "repetition_penalty",
      "top_k",
      "seed",
      "min_p",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "Novita | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000057",
      "completion": "0.0000023",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logit_bias"
    ]
  },
  {
    "id": "",
    "name": "Fireworks | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "logprobs",
      "top_logprobs",
      "response_format",
      "structured_outputs"
    ]
  },
  {
    "id": "",
    "name": "Moonshot AI | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.00000015",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty"
    ]
  },
  {
    "id": "",
    "name": "BaseTen | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "stop"
    ]
  },
  {
    "id": "",
    "name": "AtlasCloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000007",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p"
    ]
  },
  {
    "id": "",
    "name": "Parasail | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000099",
      "completion": "0.00000299",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "frequency_penalty",
      "min_p",
      "presence_penalty",
      "repetition_penalty",
      "seed",
      "stop",
      "top_k"
    ]
  },
  {
    "id": "",
    "name": "Together | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "min_p"
    ]
  },
  {
    "id": "",
    "name": "Groq | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.0000005",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "seed",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "GMICloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "seed"
    ]
  }
]
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:41 on ThreadId(2)

  2025-08-27T23:21:02.688300Z  INFO openrouter_live_kimi_tools: pretty_json:
[
  {
    "id": "",
    "name": "Targon | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000014",
      "completion": "0.00000249",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 63000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "repetition_penalty"
    ]
  },
  {
    "id": "",
    "name": "Chutes | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000000148088",
      "completion": "0.00000059264",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 75000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logprobs",
      "logit_bias",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "Nebius | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000005",
      "completion": "0.0000024",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "logit_bias",
      "logprobs",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "DeepInfra | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000055",
      "completion": "0.0000022",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "repetition_penalty",
      "top_k",
      "seed",
      "min_p",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "Novita | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000057",
      "completion": "0.0000023",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logit_bias"
    ]
  },
  {
    "id": "",
    "name": "Fireworks | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "logprobs",
      "top_logprobs",
      "response_format",
      "structured_outputs"
    ]
  },
  {
    "id": "",
    "name": "Moonshot AI | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.00000015",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty"
    ]
  },
  {
    "id": "",
    "name": "BaseTen | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "stop"
    ]
  },
  {
    "id": "",
    "name": "AtlasCloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000007",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p"
    ]
  },
  {
    "id": "",
    "name": "Parasail | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000099",
      "completion": "0.00000299",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "frequency_penalty",
      "min_p",
      "presence_penalty",
      "repetition_penalty",
      "seed",
      "stop",
      "top_k"
    ]
  },
  {
    "id": "",
    "name": "Together | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "min_p"
    ]
  },
  {
    "id": "",
    "name": "Groq | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.0000005",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "seed",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "GMICloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "seed"
    ]
  }
]
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:42 on ThreadId(2)

  2025-08-27T23:21:02.688548Z  INFO openrouter_live_kimi_tools: supported_parameters:
[
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "seed",
    "top_k",
    "repetition_penalty",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "seed",
    "top_k",
    "min_p",
    "repetition_penalty",
    "logprobs",
    "logit_bias",
    "top_logprobs",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "seed",
    "top_k",
    "logit_bias",
    "logprobs",
    "top_logprobs",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "repetition_penalty",
    "top_k",
    "seed",
    "min_p",
    "response_format",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "seed",
    "top_k",
    "min_p",
    "repetition_penalty",
    "logit_bias",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "top_k",
    "repetition_penalty",
    "logit_bias",
    "logprobs",
    "top_logprobs",
    "response_format",
    "structured_outputs",
    "tools",
    "tool_choice",
    "structured_outputs",
    "response_format",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "tools",
    "tool_choice",
    "structured_outputs",
    "response_format",
    "max_tokens",
    "temperature",
    "stop",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "max_tokens",
    "temperature",
    "top_p",
    "frequency_penalty",
    "min_p",
    "presence_penalty",
    "repetition_penalty",
    "seed",
    "stop",
    "top_k",
    "tools",
    "tool_choice",
    "structured_outputs",
    "response_format",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "frequency_penalty",
    "presence_penalty",
    "top_k",
    "repetition_penalty",
    "logit_bias",
    "min_p",
    "tools",
    "tool_choice",
    "max_tokens",
    "temperature",
    "top_p",
    "stop",
    "seed",
    "response_format",
    "structured_outputs",
    "response_format",
    "max_tokens",
    "temperature",
    "top_p",
    "seed",
]
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:45 on ThreadId(2)

  2025-08-27T23:21:30.931927Z  INFO openrouter_live_kimi_tools: pretty_json:
[
  {
    "id": "",
    "name": "Targon | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000014",
      "completion": "0.00000249",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 63000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "repetition_penalty"
    ]
  },
  {
    "id": "",
    "name": "Chutes | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000000148088",
      "completion": "0.00000059264",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 75000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logprobs",
      "logit_bias",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "Nebius | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000005",
      "completion": "0.0000024",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "logit_bias",
      "logprobs",
      "top_logprobs"
    ]
  },
  {
    "id": "",
    "name": "DeepInfra | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000055",
      "completion": "0.0000022",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "repetition_penalty",
      "top_k",
      "seed",
      "min_p",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "Novita | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000057",
      "completion": "0.0000023",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "seed",
      "top_k",
      "min_p",
      "repetition_penalty",
      "logit_bias"
    ]
  },
  {
    "id": "",
    "name": "Fireworks | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "logprobs",
      "top_logprobs",
      "response_format",
      "structured_outputs"
    ]
  },
  {
    "id": "",
    "name": "Moonshot AI | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.00000015",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty"
    ]
  },
  {
    "id": "",
    "name": "BaseTen | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000006",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131000,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "stop"
    ]
  },
  {
    "id": "",
    "name": "AtlasCloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.0000007",
      "completion": "0.0000025",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p"
    ]
  },
  {
    "id": "",
    "name": "Parasail | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.00000099",
      "completion": "0.00000299",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "max_tokens",
      "temperature",
      "top_p",
      "frequency_penalty",
      "min_p",
      "presence_penalty",
      "repetition_penalty",
      "seed",
      "stop",
      "top_k"
    ]
  },
  {
    "id": "",
    "name": "Together | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "frequency_penalty",
      "presence_penalty",
      "top_k",
      "repetition_penalty",
      "logit_bias",
      "min_p"
    ]
  },
  {
    "id": "",
    "name": "Groq | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0.0000005",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "tools",
      "tool_choice",
      "max_tokens",
      "temperature",
      "top_p",
      "stop",
      "seed",
      "response_format"
    ]
  },
  {
    "id": "",
    "name": "GMICloud | moonshotai/kimi-k2",
    "created": 0,
    "description": "",
    "architecture": {
      "input_modalities": [],
      "output_modalities": [],
      "tokenizer": "",
      "instruct_type": ""
    },
    "top_provider": {
      "is_moderated": false,
      "context_length": 0,
      "max_completion_tokens": 0
    },
    "pricing": {
      "prompt": "0.000001",
      "completion": "0.000003",
      "image": "0",
      "request": "0",
      "web_search": "0",
      "internal_reasoning": "0",
      "input_cache_read": "0",
      "input_cache_write": "0"
    },
    "canonical_slug": "",
    "context_length": 131072,
    "hugging_face_id": "",
    "per_request_limits": {},
    "supported_parameters": [
      "structured_outputs",
      "response_format",
      "max_tokens",
      "temperature",
      "top_p",
      "seed"
    ]
  }
]
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:44 on ThreadId(2)

  2025-08-27T23:21:30.932181Z  INFO openrouter_live_kimi_tools: supported_parameters:
{
    "max_tokens",
    "top_k",
    "frequency_penalty",
    "seed",
    "tool_choice",
    "repetition_penalty",
    "logit_bias",
    "logprobs",
    "structured_outputs",
    "presence_penalty",
    "min_p",
    "top_p",
    "stop",
    "top_logprobs",
    "response_format",
    "temperature",
    "tools",
}
    at crates/ploke-tui/tests/openrouter_live_kimi_tools.rs:47 on ThreadId(2)

  2025-08-27T23:32:40.535460Z  INFO ploke_rag::core: close, time.busy: 34.6µs, time.idle: 24.1µs
    at crates/ploke-rag/src/core/mod.rs:324 on ThreadId(2)
    in ploke_rag::core::bm25_rebuild

  2025-08-27T23:32:42.741999Z  INFO e2e_openrouter_tools_app: models/user returned 322 entries
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:354 on ThreadId(2)

  2025-08-27T23:32:42.926343Z  INFO e2e_openrouter_tools_app: Full response infodump:
Object {
    "data": Array [
        Object {
            "name": String("Z.AI"),
            "privacy_policy_url": Null,
            "slug": String("z-ai"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("SambaNova"),
            "privacy_policy_url": String("https://sambanova.ai/privacy-policy"),
            "slug": String("sambanova"),
            "status_page_url": String("https://status.sambanova.ai/"),
            "terms_of_service_url": String("https://sambanova.ai/terms-and-conditions"),
        },
        Object {
            "name": String("Kluster"),
            "privacy_policy_url": String("https://www.kluster.ai/privacy-policy"),
            "slug": String("klusterai"),
            "status_page_url": String("https://status.klusterai.dev/"),
            "terms_of_service_url": String("https://www.kluster.ai/terms-of-use"),
        },
        Object {
            "name": String("Together"),
            "privacy_policy_url": String("https://www.together.ai/privacy"),
            "slug": String("together"),
            "status_page_url": String("https://status.together.ai/"),
            "terms_of_service_url": String("https://www.together.ai/terms-of-service"),
        },
        Object {
            "name": String("Cerebras"),
            "privacy_policy_url": String("https://www.cerebras.ai/privacy-policy"),
            "slug": String("cerebras"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.cerebras.ai/terms-of-service"),
        },
        Object {
            "name": String("Venice"),
            "privacy_policy_url": String("https://venice.ai/legal/privacy-policy"),
            "slug": String("venice"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://venice.ai/legal/tos"),
        },
        Object {
            "name": String("Morph"),
            "privacy_policy_url": String("https://morphllm.com/privacy"),
            "slug": String("morph"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Moonshot AI"),
            "privacy_policy_url": String("https://platform.moonshot.ai/docs/agreement/userprivacy"),
            "slug": String("moonshotai"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://platform.moonshot.ai/docs/agreement/modeluse"),
        },
        Object {
            "name": String("OpenAI"),
            "privacy_policy_url": String("https://openai.com/policies/privacy-policy/"),
            "slug": String("openai"),
            "status_page_url": String("https://status.openai.com/"),
            "terms_of_service_url": String("https://openai.com/policies/row-terms-of-use/"),
        },
        Object {
            "name": String("Stealth"),
            "privacy_policy_url": Null,
            "slug": String("stealth"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("WandB"),
            "privacy_policy_url": Null,
            "slug": String("wandb"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("AtlasCloud"),
            "privacy_policy_url": String("https://www.atlascloud.ai/privacy"),
            "slug": String("atlas-cloud"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Amazon Bedrock"),
            "privacy_policy_url": String("https://aws.amazon.com/privacy"),
            "slug": String("amazon-bedrock"),
            "status_page_url": String("https://health.aws.amazon.com/health/status"),
            "terms_of_service_url": String("https://aws.amazon.com/service-terms/"),
        },
        Object {
            "name": String("Groq"),
            "privacy_policy_url": String("https://groq.com/privacy-policy/"),
            "slug": String("groq"),
            "status_page_url": String("https://status.groq.com/"),
            "terms_of_service_url": String("https://groq.com/terms-of-use/"),
        },
        Object {
            "name": String("Featherless"),
            "privacy_policy_url": String("https://featherless.ai/privacy"),
            "slug": String("featherless"),
            "status_page_url": String("https://featherless.ai/status"),
            "terms_of_service_url": String("https://featherless.ai/terms"),
        },
        Object {
            "name": String("NextBit"),
            "privacy_policy_url": String("https://www.nextbit256.com/docs/privacy-policy"),
            "slug": String("nextbit"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.nextbit256.com/docs/terms-of-service"),
        },
        Object {
            "name": String("Atoma"),
            "privacy_policy_url": Null,
            "slug": String("atoma"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://atoma.network/terms_of_service"),
        },
        Object {
            "name": String("BaseTen"),
            "privacy_policy_url": String("https://www.baseten.co/privacy-policy"),
            "slug": String("baseten"),
            "status_page_url": String("https://status.baseten.co/"),
            "terms_of_service_url": String("https://www.baseten.co/terms-and-conditions"),
        },
        Object {
            "name": String("AI21"),
            "privacy_policy_url": String("https://www.ai21.com/privacy-policy/"),
            "slug": String("ai21"),
            "status_page_url": String("https://status.ai21.com/"),
            "terms_of_service_url": String("https://www.ai21.com/terms-of-service/"),
        },
        Object {
            "name": String("Minimax"),
            "privacy_policy_url": String("https://www.minimax.io/platform/protocol/privacy-policy"),
            "slug": String("minimax"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.minimax.io/platform/protocol/terms-of-service"),
        },
        Object {
            "name": String("Mistral"),
            "privacy_policy_url": String("https://mistral.ai/terms/#privacy-policy"),
            "slug": String("mistral"),
            "status_page_url": String("https://status.mistral.ai/"),
            "terms_of_service_url": String("https://mistral.ai/terms/#terms-of-use"),
        },
        Object {
            "name": String("Anthropic"),
            "privacy_policy_url": String("https://www.anthropic.com/legal/privacy"),
            "slug": String("anthropic"),
            "status_page_url": String("https://status.anthropic.com/"),
            "terms_of_service_url": String("https://www.anthropic.com/legal/commercial-terms"),
        },
        Object {
            "name": String("Lambda"),
            "privacy_policy_url": String("https://lambda.ai/legal/privacy-policy"),
            "slug": String("lambda"),
            "status_page_url": String("https://status.lambdalabs.com/"),
            "terms_of_service_url": String("https://lambda.ai/legal/terms-of-service"),
        },
        Object {
            "name": String("Hyperbolic"),
            "privacy_policy_url": String("https://hyperbolic.xyz/privacy"),
            "slug": String("hyperbolic"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://hyperbolic.xyz/terms"),
        },
        Object {
            "name": String("NCompass"),
            "privacy_policy_url": String("https://ncompass.tech/privacy"),
            "slug": String("ncompass"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://ncompass.tech/terms"),
        },
        Object {
            "name": String("Azure"),
            "privacy_policy_url": String("https://www.microsoft.com/en-us/privacy/privacystatement"),
            "slug": String("azure"),
            "status_page_url": String("https://status.azure.com/"),
            "terms_of_service_url": String("https://www.microsoft.com/en-us/legal/terms-of-use?oneroute=true"),
        },
        Object {
            "name": String("DeepSeek"),
            "privacy_policy_url": String("https://chat.deepseek.com/downloads/DeepSeek%20Privacy%20Policy.html"),
            "slug": String("deepseek"),
            "status_page_url": String("https://status.deepseek.com/"),
            "terms_of_service_url": String("https://chat.deepseek.com/downloads/DeepSeek%20Terms%20of%20Use.html"),
        },
        Object {
            "name": String("Crusoe"),
            "privacy_policy_url": String("https://legal.crusoe.ai/open-router#cloud-privacy-policy"),
            "slug": String("crusoe"),
            "status_page_url": String("https://status.crusoecloud.com/"),
            "terms_of_service_url": String("https://legal.crusoe.ai/open-router#managed-inference-tos-open-router"),
        },
        Object {
            "name": String("Cohere"),
            "privacy_policy_url": String("https://cohere.com/privacy"),
            "slug": String("cohere"),
            "status_page_url": String("https://status.cohere.ai/"),
            "terms_of_service_url": String("https://cohere.com/terms-of-use"),
        },
        Object {
            "name": String("Google"),
            "privacy_policy_url": String("https://cloud.google.com/terms/cloud-privacy-notice"),
            "slug": String("google-vertex"),
            "status_page_url": String("https://status.cloud.google.com/products/sdXM79fz1FS6ekNpu37K/history"),
            "terms_of_service_url": String("https://cloud.google.com/terms/"),
        },
        Object {
            "name": String("Mancer 2"),
            "privacy_policy_url": String("https://mancer.tech/privacy"),
            "slug": String("mancer"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://mancer.tech/terms"),
        },
        Object {
            "name": String("Perplexity"),
            "privacy_policy_url": String("https://www.perplexity.ai/hub/legal/privacy-policy"),
            "slug": String("perplexity"),
            "status_page_url": String("https://status.perplexity.ai/"),
            "terms_of_service_url": String("https://www.perplexity.ai/hub/legal/perplexity-api-terms-of-service"),
        },
        Object {
            "name": String("Avian"),
            "privacy_policy_url": String("https://avian.io/privacy"),
            "slug": String("avian"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://avian.io/terms"),
        },
        Object {
            "name": String("Novita"),
            "privacy_policy_url": String("https://novita.ai/legal/privacy-policy"),
            "slug": String("novita"),
            "status_page_url": String("https://status.novita.ai/"),
            "terms_of_service_url": String("https://novita.ai/legal/terms-of-service"),
        },
        Object {
            "name": String("SiliconFlow"),
            "privacy_policy_url": Null,
            "slug": String("siliconflow"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Switchpoint"),
            "privacy_policy_url": Null,
            "slug": String("switchpoint"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Fireworks"),
            "privacy_policy_url": String("https://fireworks.ai/privacy-policy"),
            "slug": String("fireworks"),
            "status_page_url": String("https://status.fireworks.ai/"),
            "terms_of_service_url": String("https://fireworks.ai/terms-of-service"),
        },
        Object {
            "name": String("Inflection"),
            "privacy_policy_url": String("https://inflection.ai/privacy-policy"),
            "slug": String("inflection"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://developers.inflection.ai/tos"),
        },
        Object {
            "name": String("xAI"),
            "privacy_policy_url": String("https://x.ai/legal/privacy-policy"),
            "slug": String("xai"),
            "status_page_url": String("https://status.x.ai/"),
            "terms_of_service_url": String("https://x.ai/legal/terms-of-service-enterprise"),
        },
        Object {
            "name": String("Google AI Studio"),
            "privacy_policy_url": String("https://cloud.google.com/terms/cloud-privacy-notice"),
            "slug": String("google-ai-studio"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://cloud.google.com/terms/"),
        },
        Object {
            "name": String("Infermatic"),
            "privacy_policy_url": String("https://infermatic.ai/privacy-policy/"),
            "slug": String("infermatic"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://infermatic.ai/terms-and-conditions/"),
        },
        Object {
            "name": String("InferenceNet"),
            "privacy_policy_url": String("https://inference.net/privacy-policy"),
            "slug": String("inference-net"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://inference.net/terms-of-service"),
        },
        Object {
            "name": String("Inception"),
            "privacy_policy_url": String("https://www.inceptionlabs.ai/terms#privacy-policy"),
            "slug": String("inception"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.inceptionlabs.ai/terms"),
        },
        Object {
            "name": String("Targon"),
            "privacy_policy_url": String("https://targon.com/privacy"),
            "slug": String("targon"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://targon.com/terms"),
        },
        Object {
            "name": String("Nebius"),
            "privacy_policy_url": String("https://docs.nebius.com/legal/studio/privacy/"),
            "slug": String("nebius"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://docs.nebius.com/legal/studio/terms-of-use/"),
        },
        Object {
            "name": String("Alibaba"),
            "privacy_policy_url": String("https://www.alibabacloud.com/help/en/legal/latest/alibaba-cloud-international-website-privacy-policy"),
            "slug": String("alibaba"),
            "status_page_url": String("https://status.alibabacloud.com/"),
            "terms_of_service_url": String("https://www.alibabacloud.com/help/en/legal/latest/alibaba-cloud-international-website-product-terms-of-service-v-3-8-0"),
        },
        Object {
            "name": String("Chutes"),
            "privacy_policy_url": Null,
            "slug": String("chutes"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://chutes.ai/tos"),
        },
        Object {
            "name": String("Friendli"),
            "privacy_policy_url": String("https://friendli.ai/privacypolicy"),
            "slug": String("friendli"),
            "status_page_url": String("https://status.friendli.ai/"),
            "terms_of_service_url": String("https://friendli.ai/terms-of-service"),
        },
        Object {
            "name": String("Ubicloud"),
            "privacy_policy_url": String("https://www.ubicloud.com/docs/about/privacy-policy"),
            "slug": String("ubicloud"),
            "status_page_url": String("https://status.ubicloud.com/"),
            "terms_of_service_url": String("https://www.ubicloud.com/docs/about/terms-of-service"),
        },
        Object {
            "name": String("Cloudflare"),
            "privacy_policy_url": String("https://developers.cloudflare.com/workers-ai/privacy"),
            "slug": String("cloudflare"),
            "status_page_url": String("https://www.cloudflarestatus.com/"),
            "terms_of_service_url": String("https://www.cloudflare.com/service-specific-terms-developer-platform/#developer-platform-terms"),
        },
        Object {
            "name": String("AionLabs"),
            "privacy_policy_url": String("https://www.aionlabs.ai/privacy-policy/"),
            "slug": String("aion-labs"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.aionlabs.ai/terms/"),
        },
        Object {
            "name": String("Liquid"),
            "privacy_policy_url": String("https://www.liquid.ai/privacy-policy"),
            "slug": String("liquid"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.liquid.ai/terms-conditions"),
        },
        Object {
            "name": String("DeepInfra"),
            "privacy_policy_url": String("https://deepinfra.com/privacy"),
            "slug": String("deepinfra"),
            "status_page_url": String("https://status.deepinfra.com/"),
            "terms_of_service_url": String("https://deepinfra.com/terms"),
        },
        Object {
            "name": String("Nineteen"),
            "privacy_policy_url": Null,
            "slug": String("nineteen"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://nineteen.ai/tos"),
        },
        Object {
            "name": String("Enfer"),
            "privacy_policy_url": String("https://enfer.ai/privacy-policy"),
            "slug": String("enfer"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://enfer.ai/privacy-policy"),
        },
        Object {
            "name": String("CrofAI"),
            "privacy_policy_url": String("https://ai.nahcrof.com/privacy"),
            "slug": String("crofai"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
        Object {
            "name": String("Phala"),
            "privacy_policy_url": String("https://red-pill.ai/privacy"),
            "slug": String("phala"),
            "status_page_url": String("https://status.phala.network/"),
            "terms_of_service_url": String("https://red-pill.ai/terms"),
        },
        Object {
            "name": String("OpenInference"),
            "privacy_policy_url": String("https://www.openinference.xyz/terms"),
            "slug": String("open-inference"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.openinference.xyz/terms"),
        },
        Object {
            "name": String("Meta"),
            "privacy_policy_url": String("https://www.facebook.com/privacy/policy/"),
            "slug": String("meta"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://llama.developer.meta.com/legal/terms-of-service"),
        },
        Object {
            "name": String("Parasail"),
            "privacy_policy_url": String("https://www.parasail.io/legal/privacy-policy"),
            "slug": String("parasail"),
            "status_page_url": Null,
            "terms_of_service_url": String("https://www.parasail.io/legal/terms"),
        },
        Object {
            "name": String("GMICloud"),
            "privacy_policy_url": String("https://docs.gmicloud.ai/privacy"),
            "slug": String("gmicloud"),
            "status_page_url": Null,
            "terms_of_service_url": Null,
        },
    ],
}

    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:376 on ThreadId(2)

  2025-08-27T23:32:42.927245Z  INFO e2e_openrouter_tools_app: model: x-ai/grok-code-fast-1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:43.313640Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping x-ai/grok-code-fast-1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:43.313709Z  INFO e2e_openrouter_tools_app: model: nousresearch/hermes-4-70b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:43.484968Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping nousresearch/hermes-4-70b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:43.485061Z  INFO e2e_openrouter_tools_app: model: nousresearch/hermes-4-405b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:43.883950Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping nousresearch/hermes-4-405b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:43.884026Z  INFO e2e_openrouter_tools_app: model: google/gemini-2.5-flash-image-preview:free
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:44.072344Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for google/gemini-2.5-flash-image-preview:free: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:32:44.072394Z  WARN e2e_openrouter_tools_app: google/gemini-2.5-flash-image-preview:free | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:192 on ThreadId(2)

  2025-08-27T23:32:44.072404Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping google/gemini-2.5-flash-image-preview:free
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:44.072412Z  INFO e2e_openrouter_tools_app: model: google/gemini-2.5-flash-image-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:44.263298Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for google/gemini-2.5-flash-image-preview: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:32:44.263340Z  WARN e2e_openrouter_tools_app: google/gemini-2.5-flash-image-preview | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:192 on ThreadId(2)

  2025-08-27T23:32:44.263349Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping google/gemini-2.5-flash-image-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:44.263356Z  INFO e2e_openrouter_tools_app: model: deepseek/deepseek-chat-v3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:44.729585Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping deepseek/deepseek-chat-v3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:44.729666Z  INFO e2e_openrouter_tools_app: model: deepseek/deepseek-v3.1-base
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:44.933267Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for deepseek/deepseek-v3.1-base: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:32:44.933342Z  WARN e2e_openrouter_tools_app: deepseek/deepseek-v3.1-base | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:192 on ThreadId(2)

  2025-08-27T23:32:44.933354Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping deepseek/deepseek-v3.1-base
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:32:44.933364Z  INFO e2e_openrouter_tools_app: model: openai/gpt-4o-audio-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:32:45.227346Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for openai/gpt-4o-audio-preview: OpenAI | openai/gpt-4o-audio-preview
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:32:45.227659Z  INFO ploke_tui::event_bus: close, time.busy: 18.7µs, time.idle: 5.32µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: f8b6c9d4-c977-4b85-8ade-3d8036b7c895, content: "Switched active model to openai/gpt-4o-audio-preview via provider openai---openai-gpt-4o-audio-preview", kind: SysInfo

  2025-08-27T23:32:45.227722Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 120µs, time.idle: 26.5µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: f8b6c9d4-c977-4b85-8ade-3d8036b7c895, content: "Switched active model to openai/gpt-4o-audio-preview via provider openai---openai-gpt-4o-audio-preview", kind: SysInfo

  2025-08-27T23:32:45.227744Z  INFO ploke_tui::event_bus: close, time.busy: 1.91µs, time.idle: 2.48µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:32:45.329085Z  INFO ploke_tui::event_bus: close, time.busy: 30.2µs, time.idle: 19.0µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:32:45.329189Z  INFO ploke_tui::event_bus: close, time.busy: 2.65µs, time.idle: 2.75µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:32:45.329258Z  INFO ploke_tui::llm: Received LLM request for parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66
new_msg_id: a4b9ce00-2b6a-42b6-88b8-1d9fe35901ce
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:32:45.329279Z  INFO ploke_tui::llm: Received context for parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:32:45.329311Z  INFO ploke_tui::llm: pending_requests found match for req_parent: dc42d093-6ab8-4921-906b-aebc8dd96e66
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:32:45.329321Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: dc42d093-6ab8-4921-906b-aebc8dd96e66
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:32:45.329345Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:32:45.329413Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5044f8f-4129-4401-99a2-6e03161df541, parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: a4b9ce00-2b6a-42b6-88b8-1d9fe35901ce }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66 })

  2025-08-27T23:32:45.329435Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5044f8f-4129-4401-99a2-6e03161df541, parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: a4b9ce00-2b6a-42b6-88b8-1d9fe35901ce }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66 })

  2025-08-27T23:32:45.329497Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5044f8f-4129-4401-99a2-6e03161df541, parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: a4b9ce00-2b6a-42b6-88b8-1d9fe35901ce }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66 })

  2025-08-27T23:32:45.329522Z  INFO ploke_tui::llm: close, time.busy: 87.0µs, time.idle: 39.8µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: c5044f8f-4129-4401-99a2-6e03161df541, parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: a4b9ce00-2b6a-42b6-88b8-1d9fe35901ce }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 1 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: dc42d093-6ab8-4921-906b-aebc8dd96e66 })

  2025-08-27T23:33:05.383432Z  INFO e2e_openrouter_tools_app: model: mistralai/mistral-medium-3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:33:05.638562Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for mistralai/mistral-medium-3.1: Mistral | mistralai/mistral-medium-3.1
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:33:05.638810Z  INFO ploke_tui::event_bus: close, time.busy: 18.6µs, time.idle: 5.84µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 696c1b5a-54d3-4ced-94c7-d19fee4a511d, content: "Switched active model to mistralai/mistral-medium-3.1 via provider mistral---mistralai-mistral-medium-3-1", kind: SysInfo

  2025-08-27T23:33:05.638869Z  INFO ploke_tui::app_state::handlers::chat: close, time.busy: 103µs, time.idle: 22.3µs
    at crates/ploke-tui/src/app_state/handlers/chat.rs:146 on ThreadId(2)
    in ploke_tui::app_state::handlers::chat::add_msg_immediate with event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, new_msg_id: 696c1b5a-54d3-4ced-94c7-d19fee4a511d, content: "Switched active model to mistralai/mistral-medium-3.1 via provider mistral---mistralai-mistral-medium-3-1", kind: SysInfo

  2025-08-27T23:33:05.638889Z  INFO ploke_tui::event_bus: close, time.busy: 2.06µs, time.idle: 2.33µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:33:05.740138Z  INFO ploke_tui::event_bus: close, time.busy: 13.0µs, time.idle: 10.1µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:33:05.740193Z  INFO ploke_tui::event_bus: close, time.busy: 2.42µs, time.idle: 2.75µs
    at crates/ploke-tui/src/event_bus/mod.rs:195 on ThreadId(2)
    in ploke_tui::event_bus::send

  2025-08-27T23:33:05.740236Z  INFO ploke_tui::llm: Received LLM request for parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6
new_msg_id: 4e8b159d-c0f3-40b4-860b-957fc500a255
    at crates/ploke-tui/src/llm/mod.rs:279 on ThreadId(2)

  2025-08-27T23:33:05.740251Z  INFO ploke_tui::llm: Received context for parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6
    at crates/ploke-tui/src/llm/mod.rs:290 on ThreadId(2)

  2025-08-27T23:33:05.740268Z  INFO ploke_tui::llm: pending_requests found match for req_parent: c8198deb-d787-4664-8f2c-296a3ec17ea6
    at crates/ploke-tui/src/llm/mod.rs:312 on ThreadId(2)

  2025-08-27T23:33:05.740276Z  INFO ploke_tui::llm: ready_contexts found match for req_parent: c8198deb-d787-4664-8f2c-296a3ec17ea6
    at crates/ploke-tui/src/llm/mod.rs:317 on ThreadId(2)

  2025-08-27T23:33:05.740292Z  INFO ploke_tui::llm: removing id from pending_requests
    at crates/ploke-tui/src/llm/mod.rs:330 on ThreadId(2)

  2025-08-27T23:33:05.740350Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:489 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 771938cd-290c-4c45-87d7-4e7212556b85, parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 4e8b159d-c0f3-40b4-860b-957fc500a255 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6 })

  2025-08-27T23:33:05.740370Z  INFO ploke_tui::llm: Inside process_llm_request
    at crates/ploke-tui/src/llm/mod.rs:501 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 771938cd-290c-4c45-87d7-4e7212556b85, parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 4e8b159d-c0f3-40b4-860b-957fc500a255 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6 })

  2025-08-27T23:33:05.740421Z ERROR ploke_tui::llm: Failed to create assistant message: state_manager dropped responder.
    at /home/brasides/code/openai-codex/ploke/crates/ploke-tui/src/llm/mod.rs:518 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 771938cd-290c-4c45-87d7-4e7212556b85, parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 4e8b159d-c0f3-40b4-860b-957fc500a255 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6 })

  2025-08-27T23:33:05.740445Z  INFO ploke_tui::llm: close, time.busy: 79.5µs, time.idle: 32.1µs
    at crates/ploke-tui/src/llm/mod.rs:479 on ThreadId(2)
    in ploke_tui::llm::process_llm_request with request: Request { request_id: 771938cd-290c-4c45-87d7-4e7212556b85, parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6, prompt: "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.", parameters: LLMParameters { model: "moonshotai/kimi-k2", temperature: None, top_p: None, max_tokens: None, presence_penalty: None, frequency_penalty: None, stop_sequences: [], parallel_tool_calls: true, response_format: Text, safety_settings: SafetySettings { hate: 0, harassment: 0, self_harm: 0, sexual_content: 0 }, system_prompt: None, tool_max_retries: Some(2), tool_token_limit: Some(2048), history_char_budget: Some(12000), tool_timeout_secs: Some(30) }, new_msg_id: 4e8b159d-c0f3-40b4-860b-957fc500a255 }, cmd_tx: Sender { chan: Tx { inner: Chan { tx: Tx { block_tail: 0x7f09e432e750, tail_position: 3 }, semaphore: Semaphore { semaphore: Semaphore { permits: 1024 }, bound: 1024 }, rx_waker: AtomicWaker, tx_count: 4, rx_fields: "..." } } }, event_bus: EventBus { realtime_tx: broadcast::Sender, background_tx: broadcast::Sender, error_tx: broadcast::Sender, index_tx: broadcast::Sender }, context: Some(PromptConstructed { prompt: [(System, "\n<-- SYSTEM PROMPT -->\nYou are a highly skilled software engineer, specializing in the Rust programming language.\n\nYou will be asked to provide some assistance in collaborating with the user.\n\nTool-aware code collaboration instructions\n\nYou can call tools to request more context and to stage code edits for user approval.\nUse the tools ONLY as described below.\n\nCode context format\n- You will receive code snippets as system messages. Headers may include:\n  - File: absolute path to the file\n  - Span: byte or line range the snippet covers\n  - File Hash: a UUID identifying the current on-disk content (TrackingHash)\n- Snippet hashes and byte ranges are for validation on our side; you should not compute them.\n\nHow to request more context\n- Call the tool request_code_context when you need additional code to proceed.\n- Arguments:\n  - token_budget: integer > 0 indicating approximately how many tokens of code to return\n  - hint: optional string that narrows the search (file path, symbol name, module, brief description)\n- Keep requests focused and iterative.\n\nHow to fetch file metadata (TrackingHash)\n- If you need file metadata for reasoning, call get_file_metadata with:\n  - file_path: absolute path to the file on disk\n- The tool returns the file's current tracking hash (UUID), byte length, and modified time.\n\nHow to propose code edits (rewrite an entire item)\n- Call apply_code_edit with:\n  {\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"example_crate/src/main.rs\",            // path relative to your project root\n        \"canon\": \"module_one::example_module::Thing\",   // canonical path of the item (no leading 'crate')\n        \"node_type\": \"function\",                         // one of: function|struct|enum|trait|type_alias|module|static|const|macro|import|impl|union\n        \"code\": \"fn thing() { /* new implementation */ }\"\n      }\n    ]\n  }\n- Notes:\n  - You do NOT provide byte offsets or hashes; we will resolve the canonical path to a node span and validate file hashes internally.\n  - Provide complete item definitions (rewrite), including attributes and docs where appropriate.\n\nExamples\n- Request context for a file by path:\n  request_code_context({ \"token_budget\": 2000, \"hint\": \"file: crates/ploke-tui/src/app_state/handlers/rag.rs\" })\n- Request context for a symbol:\n  request_code_context({ \"token_budget\": 1500, \"hint\": \"function: handle_tool_call_requested in rag.rs\" })\n- Stage a single-item rewrite:\n  apply_code_edit({\n    \"edits\": [\n      {\n        \"action\": \"code_edit\",\n        \"file\": \"crates/ploke-tui/src/app_state/handlers/rag.rs\",\n        \"canon\": \"app_state::handlers::rag::handle_tool_call_requested\",\n        \"node_type\": \"function\",\n        \"code\": \"pub async fn handle_tool_call_requested(/* ... */) { /* new body */ }\"\n      }\n    ]\n  })\n\nConversation structure\n- After the Code section below, the User's query appears under a # USER header.\n- If additional responses from collaborators appear (Assistant/Collaborator), treat them as context.\n- When uncertain, ask for missing details or request additional context precisely.\n\n# Code\n\n"), (User, "Hello, I would like you to help me understand the difference between the SimpleStruct and the GenericStruct in my code.\n\nIf tools are available, you MUST call the `request_code_context` tool with {\"token_budget\": 256} and wait for the tool result before responding.")], parent_id: c8198deb-d787-4664-8f2c-296a3ec17ea6 })

  2025-08-27T23:33:25.787738Z  INFO e2e_openrouter_tools_app: model: baidu/ernie-4.5-21b-a3b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:401 on ThreadId(2)

  2025-08-27T23:33:25.939372Z  INFO e2e_openrouter_tools_app: tools-capable endpoints cached for baidu/ernie-4.5-21b-a3b: 
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:181 on ThreadId(2)

  2025-08-27T23:33:25.939437Z  WARN e2e_openrouter_tools_app: baidu/ernie-4.5-21b-a3b | No candidates found for model with tools
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:192 on ThreadId(2)

  2025-08-27T23:33:25.939447Z  INFO e2e_openrouter_tools_app:   no tools-capable endpoints; skipping baidu/ernie-4.5-21b-a3b
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:412 on ThreadId(2)

  2025-08-27T23:33:25.941610Z  INFO e2e_openrouter_tools_app: Summary: total_outcomes=4 successes=0 no_tool_calls=4 http_404_first_leg=0 http_429_any_leg=0
    at crates/ploke-tui/tests/e2e_openrouter_tools_app.rs:575 on ThreadId(2)

