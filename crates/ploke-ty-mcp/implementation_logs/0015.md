# 0015 – Preflight command checks and manager hardening

Decisions
- Add a preflight PATH check in McpManager::spawn_service to fail fast with a clear error when required commands (e.g., uvx, npx) are missing.
- Keep health check and backoff unchanged; they already align with restart-on-exit semantics and time-budget honoring.

Changes Summary
- manager.rs: Added which::which-based preflight before spawning the child process; improves error clarity for missing binaries.
- Cargo.toml: Added dependency on which = "6" for reliable PATH resolution.

Next Steps
- Introduce optional per-server "preflight_args" (e.g., "--version") to validate a server binary is healthy without incurring a full list_tools call. Keep disabled by default.
- Consider moving example helpers (src/context7_client.rs, src/git_client.rs) into examples/ to reduce crate surface.
- Add a unit test for the missing-binary path by injecting a fake spec with a known-bad command.

Suggested PLAN.md Edits
- None required; this change fulfills the “External tool presence: detect and error clearly” mitigation noted under Risks.
